<h1
id="i.hyper.smac---smac-atmospheric-correction-for-hyperspectral-data">i.hyper.smac
- SMAC Atmospheric Correction for Hyperspectral Data</h1>
<h2 id="description">DESCRIPTION</h2>
<p>This module implements the Simplified Method for Atmospheric
Correction (SMAC) for hyperspectral data in GRASS GIS. It provides two
methods for atmospheric correction:</p>
<ol type="1">
<li><strong>Simple SMAC</strong>: A faster, less accurate method
suitable for quick processing</li>
<li><strong>Libradtran SMAC</strong>: A more accurate method using the
libRadtran radiative transfer model</li>
</ol>
<p>The module is based on the original SMAC algorithm developed by <a
href="https://doi.org/10.1016/0034-4257(94)90119-8">Rahman and Dedieu
(1994)</a> and the implementation by <a
href="https://github.com/olivierhagolle/SMAC">Olivier Hagolle</a>.</p>
<h2 id="features">FEATURES</h2>
<ul>
<li>Supports multiple hyperspectral sensors (AVIRIS, HYPERION, PRISMA, etc.)</li>
<li>Two correction methods: simple and libradtran-based</li>
<li>Automatic estimation of atmospheric parameters:
  <ul>
    <li>Aerosol Optical Depth (AOD) using the Dense Dark Vegetation (DDV) method</li>
    <li>Water Vapor Content (WVC) using atmospheric absorption features</li>
  </ul>
</li>
<li>Uses libRadtran for accurate atmospheric simulations (for libradtran method)</li>
<li>Handles both per-pixel and scene-average atmospheric correction</li>
<li>Preserves the original data structure and metadata</li>
</ul>
<h2 id="requirements">REQUIREMENTS</h2>
<ul>
<li>GRASS GIS 8.0 or later</li>
<li>Python 3.x</li>
<li>NumPy</li>
<li>PyEphem (for solar zenith angle estimation)</li>
<li>libRadtran (for atmospheric simulations)</li>
<li>scipy (for interpolation and optimization)</li>
<li>pandas (for data handling)</li>
<li>scikit-learn (for regression models in AOD estimation)</li>
</ul>
<h2 id="usage">USAGE</h2>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple SMAC (default)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=name output=name elevation=name <span class="pp">[</span><span class="ss">sensor=string</span><span class="pp">]</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[aod=float]</span> <span class="pp">[</span><span class="ss">water_vapor=float</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">ozone=float</span><span class="pp">]</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[solar_zenith=float]</span> <span class="pp">[</span><span class="ss">solar_azimuth=float</span><span class="pp">]</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[view_zenith=float]</span> <span class="pp">[</span><span class="ss">view_azimuth=float</span><span class="pp">]</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[--overwrite]</span> <span class="pp">[--</span><span class="ss">verbose</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">quiet</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">keep</span><span class="pp">-</span><span class="ss">temp</span><span class="pp">]</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Libradtran SMAC</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=name output=name elevation=name method=libradtran</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>             <span class="va">sensor</span><span class="op">=</span>string <span class="ex">[aod=float]</span> <span class="pp">[</span><span class="ss">water_vapor=float</span><span class="pp">]</span> <span class="pp">[</span><span class="ss">ozone=float</span><span class="pp">]</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[solar_zenith=float]</span> <span class="pp">[</span><span class="ss">solar_azimuth=float</span><span class="pp">]</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[view_zenith=float]</span> <span class="pp">[</span><span class="ss">view_azimuth=float</span><span class="pp">]</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[aot_lut=name]</span> <span class="pp">[</span><span class="ss">visibility=float</span><span class="pp">]</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>             <span class="ex">[aerosol_type=string]</span> <span class="pp">[--</span><span class="ss">overwrite</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">verbose</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">quiet</span><span class="pp">]</span> <span class="pp">[--</span><span class="ss">keep</span><span class="pp">-</span><span class="ss">temp</span><span class="pp">]</span></span></code></pre></div>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="inputoutput">Input/Output</h3>
<ul>
<li><strong>input</strong> - Name of input 3D raster map</li>
<li><strong>output</strong> - Name for output 3D raster map</li>
<li><strong>elevation</strong> - Name of elevation raster map (default:
DEM from GRASS location)</li>
</ul>
<h3 id="method-selection">Method Selection</h3>
<ul>
<li><strong>method</strong> - Atmospheric correction method (simple,
libradtran; default: simple)</li>
</ul>
<h3 id="atmospheric-parameters-both-methods">Atmospheric Parameters
(both methods)</h3>
<ul>
<li><strong>sensor</strong> - Sensor type (AVIRIS, HYPERION, PRISMA,
etc.)</li>
<li><strong>aod</strong> - Aerosol Optical Depth at 550nm (if not
provided, will be estimated)</li>
<li><strong>water_vapor</strong> - Water vapor content in g/cm² (if not
provided, will be estimated)</li>
<li><strong>ozone</strong> - Ozone content in cm-atm (default: 0.3)</li>
<li><strong>solar_zenith</strong> - Solar zenith angle in degrees
(required)</li>
<li><strong>solar_azimuth</strong> - Solar azimuth angle in degrees
(default: 0)</li>
<li><strong>view_zenith</strong> - View zenith angle in degrees
(default: 0)</li>
<li><strong>view_azimuth</strong> - View azimuth angle in degrees
(default: 0)</li>
<li><strong>aerosol_type</strong> - Aerosol type (continental, maritime,
urban, desert; default: continental)</li>
</ul>
<h3 id="libradtran-specific-parameters">Libradtran-specific
Parameters</h3>
<ul>
<li><strong>aot_lut</strong> - Look-up table for AOD estimation (if not
provided, will be generated)</li>
<li><strong>visibility</strong> - Visibility in km (if not provided,
will be estimated from AOD)</li>
</ul>
<h2 id="examples">EXAMPLES</h2>
<h3 id="simple-smac-with-automatic-parameter-estimation">Simple SMAC with automatic parameter estimation</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatically estimate AOD and water vapor</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=hyperspectral output=corrected elevation=dem sensor=AVIRIS</span></code></pre></div>

<h3 id="simple-smac-with-manual-parameters">Simple SMAC with manual parameter specification</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually specify AOD and water vapor</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=hyperspectral output=corrected elevation=dem sensor=AVIRIS <span class="kw">\</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  aod=0.2 water_vapor=2.5</span></code></pre></div>
<h3 id="simple-smac-with-specific-atmospheric-parameters">Simple SMAC
with specific atmospheric parameters</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=hyperspectral output=corrected elevation=dem sensor=HYPERION <span class="dt">\</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  aod=0.2 water_vapor=2.5 solar_zenith=30</span></code></pre></div>
<h3 id="libradtran-smac-with-custom-parameters">Libradtran SMAC with
custom parameters</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=hyperspectral output=corrected elevation=dem method=libradtran <span class="dt">\</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  sensor=AVIRIS aod=0.15 water_vapor=2.0 solar_zenith=25 <span class="dt">\</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  aerosol_type=maritime visibility=50</span></code></pre></div>
<h3 id="using-an-aot-look-up-table-with-libradtran">Using an AOT look-up
table with Libradtran</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">i.hyper.smac</span> input=hyperspectral output=corrected elevation=dem method=libradtran <span class="dt">\</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  sensor=PRISMA aot_lut=aot_lookup.txt solar_zenith=30</span></code></pre></div>
<h2 id="notes">NOTES</h2>
<h3>Automatic Parameter Estimation</h3>
<ul>
  <li><strong>AOD Estimation</strong>: Uses the Dense Dark Vegetation (DDV) method, which identifies dark vegetation pixels and uses their reflectance in the blue region</li>
  <li><strong>Water Vapor Estimation</strong>: Uses atmospheric absorption features around 940nm and 1130nm</li>
  <li><strong>Fallback Values</strong>: If estimation fails, default values are used (AOD=0.15, Water Vapor=2.0 g/cm²)</li>
</ul>
<h3>Performance Considerations</h3>
<ul>
  <li>The simple method is faster but less accurate than the libradtran method</li>
  <li>AOD and WVC estimation add computational overhead but improve accuracy</li>
  <li>The module creates temporary files in the current mapset (use <code>--keep-temp</code> to preserve them)</li>
</ul>
<h3>Requirements</h3>
<ul>
  <li>The libradtran method requires the libRadtran software to be installed and properly configured</li>
  <li>Additional Python packages (scipy, pandas, scikit-learn) are required for parameter estimation</li>
</ul>
<h3>Supported Sensors</h3>
<ul>
  <li>PRISMA, AVIRIS, AVIRIS_NG, HYPERION, ENMAP, OSK_GHOST, PIXEL, ESPER, IPERLITE, KUVASPACE_23, KUVASPACE_32, WYVERN_23, WYVERN_32, HYP4U, TANAGER</li>
</ul>
<h3>Best Practices</h3>
<ul>
  <li>For best results, provide as much metadata as possible</li>
  <li>Verify the estimated parameters using the module's output messages</li>
  <li>Consider using the <code>--keep-temp</code> flag for debugging if results are unexpected</li>
</ul>
<h2 id="references">REFERENCES</h2>
<ul>
<li>Rahman, H., &amp; Dedieu, G. (1994). SMAC: a simplified method for
the atmospheric correction of satellite measurements in the solar
spectrum. <em>International Journal of Remote Sensing</em>, 15(1),
123-143.</li>
<li>Original SMAC implementation: <a
href="https://github.com/olivierhagolle/SMAC">https://github.com/olivierhagolle/SMAC</a></li>
</ul>
<h2 id="authors">AUTHORS</h2>
<ul>
<li>Original SMAC algorithm: H. Rahman and G. Dedieu</li>
<li>GRASS GIS implementation: Yann</li>
</ul>
<h2 id="source-code">SOURCE CODE</h2>
<p>Available at: <a href="https://github.com/OSGeo/grass-addons">GRASS
GIS Addons Repository</a></p>
<h2 id="see-also">SEE ALSO</h2>
<ul>
<li><a
href="https://grass.osgeo.org/grass-stable/manuals/r.smap.html">r.smap</a></li>
<li><a
href="https://grass.osgeo.org/grass-stable/manuals/i.atcorr.html">i.atcorr</a></li>
<li><a
href="https://grass.osgeo.org/grass-stable/manuals/i.vi.html">i.vi</a></li>
</ul>
